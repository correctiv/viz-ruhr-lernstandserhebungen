{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap 4766e489568311bf4d6a","webpack:///./src/scripts/config.js","webpack:///./src/scripts/index.js","webpack:///./src/scripts/multi_bars.js","webpack:///./src/scripts/multi_maps.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","COLORS","SUBJECTS","math","german","english_listen","english_read","_interopRequireDefault","obj","__esModule","default","_multi_maps","_multi_maps2","_multi_bars","_multi_bars2","Object","defineProperty","value","_config","dataUrl","cssNamespace","wrapperEl","d3","select","csv","data","forms","columns","keys","map","s","splice","getData","form","_data","filter","d","schulform","find","fach","getChartData","k","indexOf","sort","reverse","y","x","append","attr","selectAll","enter","classed","text","html","chart_id","playbooks","horizontalBarChart","elementId","color","barMargin","margin","top","right","bottom","left","showXAxis","showYAxis","getXDomain","responsiveSvg","render","geoDataUrl","wrapperId","width","height","yExtent","valueColSuffix","json","geoData","topojson","feature","objects","rvr_districts","choroplethMap","defaults","nullColor","getId","f","properties","RS","maps","hilight","master","slug","control","trigger","riot","EVT","updateInfobox","updateSelector","wrapper","i","element","yCol","on","mouseover","_ref","infobox","template","legend","wrapperTemplate","itemTemplate","selector","getLabel","GEN"],"mappings":"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","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(2);\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tmodule.exports = {\n\t\n\t  COLORS: ['#f9c280', '#dfad71', '#c59962', '#ab8454', '#917045', '#775b36', '#5e4728'],\n\t\n\t  SUBJECTS: {\n\t    math: 'Mathe',\n\t    german: 'Deutsch',\n\t    english_listen: 'Englisch (Hören)',\n\t    english_read: 'Englisch (Lesen)'\n\t  }\n\t\n\t};\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _multi_maps = __webpack_require__(4);\n\t\n\tvar _multi_maps2 = _interopRequireDefault(_multi_maps);\n\t\n\tvar _multi_bars = __webpack_require__(3);\n\t\n\tvar _multi_bars2 = _interopRequireDefault(_multi_bars);\n\t\n\t__webpack_require__(5);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tif (false) {\n\t  module.hot.accept();\n\t}\n\t\n\t// import 'babel-polyfill'\n\t\n\t\n\t(0, _multi_maps2.default)();\n\t(0, _multi_bars2.default)();\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _config = __webpack_require__(1);\n\t\n\texports.default = function () {\n\t\n\t  // config\n\t  var dataUrl = './data/schulformen.csv';\n\t  var cssNamespace = 'multi-bars';\n\t  var wrapperEl = d3.select('#' + cssNamespace);\n\t\n\t  d3.csv(dataUrl, function (data) {\n\t\n\t    var forms = ['Gymnasium', 'Hauptschule', 'Realschule', 'Schulen des längeren gemeinsamen Lernens'];\n\t\n\t    var columns = Object.keys(_config.SUBJECTS).map(function (s) {\n\t      return _config.SUBJECTS[s];\n\t    });\n\t    columns.splice(0, 0, null);\n\t\n\t    var getData = function getData(form) {\n\t      var _data = data.filter(function (d) {\n\t        return d.schulform == form;\n\t      });\n\t      return columns.map(function (c) {\n\t        return c ? _data.find(function (d) {\n\t          return d.fach == c;\n\t        }) : c;\n\t      });\n\t    };\n\t\n\t    var getChartData = function getChartData(data) {\n\t      var keys = Object.keys(data).filter(function (k) {\n\t        return k.indexOf('niveau') > -1 && k.indexOf('6') < 0;\n\t      }).sort().reverse();\n\t      return keys.map(function (k) {\n\t        return {\n\t          y: k,\n\t          x: data[k]\n\t        };\n\t      });\n\t    };\n\t\n\t    // header row\n\t    wrapperEl.append('div').attr('class', cssNamespace + '__row ' + cssNamespace + '__row--header').selectAll('div').data(columns).enter().append('div').attr('class', cssNamespace + '__cell').classed(cssNamespace + '__cell--empty', function (d) {\n\t      return !d;\n\t    }).text(function (d) {\n\t      return d;\n\t    });\n\t\n\t    // data rows\n\t    wrapperEl.append('div').selectAll('div').data(forms).enter().append('div').attr('class', cssNamespace + '__row ' + cssNamespace + '__row--section').html(function (d) {\n\t      return '<h3>' + d + '</h3>';\n\t    }).append('div').selectAll('div').data(function (d) {\n\t      return getData(d);\n\t    }).enter().append('div').attr('class', cssNamespace + '__cell').classed(cssNamespace + '__cell--chart', function (d) {\n\t      return d;\n\t    }).classed(cssNamespace + '__cell--empty', function (d) {\n\t      return !d;\n\t    }).append('div').attr('id', function (d) {\n\t      return d && d.chart_id;\n\t    });\n\t\n\t    // render charts into created divs\n\t    data.map(function (d) {\n\t\n\t      d3.playbooks.horizontalBarChart({\n\t        elementId: d.chart_id,\n\t        data: getChartData(d),\n\t        color: function color(d) {\n\t          return d.y.indexOf('0') < 0 && d.y.indexOf('1') < 0 ? _config.COLORS[0] : _config.COLORS[3];\n\t        },\n\t        barMargin: 10,\n\t        margin: {\n\t          top: 0,\n\t          right: 0,\n\t          bottom: 0,\n\t          left: 0\n\t        },\n\t        showXAxis: false,\n\t        // xScaleNice: false,\n\t        // xTicks: 2,\n\t        showYAxis: false,\n\t        getXDomain: function getXDomain() {\n\t          return [0, 75];\n\t        },\n\t        responsiveSvg: true\n\t      }).render();\n\t    });\n\t  });\n\t};\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _config = __webpack_require__(1);\n\t\n\texports.default = function () {\n\t\n\t  // options\n\t  var dataUrl = './data/data.csv';\n\t  var geoDataUrl = './data/rvr_districts.topo.json';\n\t  var wrapperId = 'multi-maps';\n\t  var cssNamespace = 'multi-map';\n\t  var legendId = '#multi-maps-legend';\n\t  var infoboxId = '#multi-maps-infobox';\n\t  var selectorId = '#multi-maps-selector';\n\t  var width = 846;\n\t  var height = 480;\n\t  var yExtent = [0, 35];\n\t  var valueColSuffix = 'risiko_rel';\n\t\n\t  d3.json(geoDataUrl, function (d) {\n\t    var geoData = topojson.feature(d, d.objects.rvr_districts);\n\t\n\t    d3.csv(dataUrl, function (data) {\n\t\n\t      d3.playbooks.choroplethMap.defaults({\n\t        color: _config.COLORS,\n\t        nullColor: '#ededed',\n\t        cssNamespace: cssNamespace,\n\t        height: height,\n\t        width: width,\n\t        data: data,\n\t        geoData: geoData,\n\t        yExtent: yExtent,\n\t        getId: function getId(f) {\n\t          return f.properties.RS;\n\t        },\n\t        responsiveSvg: true\n\t      });\n\t\n\t      var maps = {};\n\t      // broadcast hilighting\n\t      var hilight = function hilight(master, slug, data) {\n\t        // hilight all others:\n\t        Object.keys(maps).filter(function (s) {\n\t          return s !== slug;\n\t        }).map(function (k) {\n\t          maps[k].hilight(data);\n\t        });\n\t        if (!master) {\n\t          // trigger infobox update for master map\n\t          var control = maps[Object.keys(maps)[0]].control();\n\t          control.trigger(riot.EVT.updateInfobox, data);\n\t          control.trigger(riot.EVT.updateSelector, data);\n\t        }\n\t      };\n\t\n\t      var wrapper = d3.select('#' + wrapperId);\n\t      var i = 0;\n\t      Object.keys(_config.SUBJECTS).map(function (s) {\n\t        var elementId = wrapperId + '--' + s;\n\t        var element = wrapper.append('div').attr('id', elementId).attr('class', 'multi-map__container');\n\t        element.append('h4').attr('class', 'multi-map__title').text(_config.SUBJECTS[s]);\n\t        maps[s] = d3.playbooks.choroplethMap({\n\t          elementId: elementId,\n\t          yCol: s + '__' + valueColSuffix\n\t        }).render();\n\t\n\t        // render master legends/infobox/selector for first iteration\n\t        if (!i) {\n\t          maps[s].infobox({\n\t            element: '#multi-maps-infobox',\n\t            template: '\\n              <h4 class=\"cor-viz-ls__infobox-title\">Anteil der Risikosch\\xFCler</h4>\\n              <p>in {GEN}</p>\\n              <dl class=\"fixme\">\\n                <dt>{math__risiko_rel} %</dd>\\n                <dd>Mathe</dt>\\n                <dt>{german__risiko_rel} %</dd>\\n                <dd>Deutsch</dt>\\n                <dt>{english_listen__risiko_rel} %</dd>\\n                <dd>Englisch (H\\xF6ren)</dt>\\n                <dt>{english_read__risiko_rel} %</dd>\\n                <dd>Englisch (Lesen)</dt>\\n              </dl>\\n              <p class=\"data--small\">Teilnehmer: {participating}</p>\\n            '\n\t          }).legend({\n\t            wrapperTemplate: '\\n                <h4 class=\"multi-map__legend-title\">Anteil in %</h4>\\n                <div class=\"multi-map__legend-items\">\\n                  {body}\\n                </div>',\n\t            itemTemplate: '<span class=\"multi-map__legend-item\" style=\"background-color:{color};\">{label}</span>',\n\t            element: '#multi-maps-legend'\n\t          }).selector({\n\t            element: '#multi-maps-selector',\n\t            getLabel: function getLabel(f) {\n\t              return f.GEN;\n\t            }\n\t          });\n\t\n\t          // broadcast hilighting\n\t\n\t          maps[s].control().on(riot.EVT.updateInfobox, function (d) {\n\t            return hilight(true, s, d);\n\t          });\n\t        } else {\n\t          maps[s].control().on(riot.EVT.mouseover, function (_ref) {\n\t            var data = _ref.data;\n\t            return hilight(false, s, data);\n\t          });\n\t        }\n\t\n\t        i++;\n\t      });\n\t    });\n\t  });\n\t};\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4766e489568311bf4d6a","module.exports = {\n\n  COLORS: ['#f9c280', '#dfad71', '#c59962', '#ab8454', '#917045', '#775b36', '#5e4728'],\n\n  SUBJECTS: {\n    math: 'Mathe',\n    german: 'Deutsch',\n    english_listen: 'Englisch (Hören)',\n    english_read: 'Englisch (Lesen)'\n  }\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/config.js","'use strict'\n\nif (module.hot) {\n  module.hot.accept()\n}\n\n// import 'babel-polyfill'\nimport renderMultiMaps from '../scripts/multi_maps.js'\nimport renderMultiBars from '../scripts/multi_bars.js'\nimport '../styles/index.scss'\n\nrenderMultiMaps()\nrenderMultiBars()\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/index.js","import {COLORS, SUBJECTS} from './config.js'\n\nexport default () => {\n\n  // config\n  const dataUrl = './data/schulformen.csv'\n  const cssNamespace = 'multi-bars'\n  const wrapperEl = d3.select(`#${cssNamespace}`)\n\n  d3.csv(dataUrl, data => {\n\n    const forms = [\n      'Gymnasium',\n      'Hauptschule',\n      'Realschule',\n      'Schulen des längeren gemeinsamen Lernens'\n    ]\n\n    const columns = Object.keys(SUBJECTS).map(s => SUBJECTS[s])\n    columns.splice(0, 0, null)\n\n    const getData = form => {\n      const _data = data.filter(d => d.schulform == form)\n      return columns.map(c => c ? _data.find(d => d.fach == c) : c)\n    }\n\n    const getChartData = data => {\n      const keys = Object.keys(data).filter(k => k.indexOf('niveau') > -1 && k.indexOf('6') < 0).sort().reverse()\n      return keys.map(k => {\n        return {\n          y: k,\n          x: data[k]\n        }\n      })\n    }\n\n    // header row\n    wrapperEl.append('div')\n        .attr('class', `${cssNamespace}__row ${cssNamespace}__row--header`)\n        .selectAll('div').data(columns).enter()\n      .append('div')\n        .attr('class', `${cssNamespace}__cell`)\n        .classed(`${cssNamespace}__cell--empty`, d => !d)\n        .text(d => d)\n\n    // data rows\n    wrapperEl.append('div').selectAll('div').data(forms).enter()\n      .append('div')\n        .attr('class', `${cssNamespace}__row ${cssNamespace}__row--section`)\n        .html(d => `<h3>${d}</h3>`)\n      .append('div').selectAll('div').data(d => getData(d)).enter()\n      .append('div')\n        .attr('class', `${cssNamespace}__cell`)\n        .classed(`${cssNamespace}__cell--chart`, d => d)\n        .classed(`${cssNamespace}__cell--empty`, d => !d)\n      .append('div')\n        .attr('id', d => d && d.chart_id)\n\n    // render charts into created divs\n    data.map(d => {\n\n      d3.playbooks.horizontalBarChart({\n        elementId: d.chart_id,\n        data: getChartData(d),\n        color: d => d.y.indexOf('0') < 0 && d.y.indexOf('1') < 0 ? COLORS[0] : COLORS[3],\n        barMargin: 10,\n        margin: {\n          top: 0,\n          right: 0,\n          bottom: 0,\n          left: 0\n        },\n        showXAxis: false,\n        // xScaleNice: false,\n        // xTicks: 2,\n        showYAxis: false,\n        getXDomain: () => [0, 75],\n        responsiveSvg: true,\n      }).render()\n\n    })\n\n  })\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/multi_bars.js","import {COLORS, SUBJECTS} from './config.js'\n\nexport default () => {\n\n  // options\n  const dataUrl = './data/data.csv'\n  const geoDataUrl = './data/rvr_districts.topo.json'\n  const wrapperId = 'multi-maps'\n  const cssNamespace = 'multi-map'\n  const legendId = '#multi-maps-legend'\n  const infoboxId = '#multi-maps-infobox'\n  const selectorId = '#multi-maps-selector'\n  const width = 846\n  const height = 480\n  const yExtent = [0, 35]\n  const valueColSuffix = 'risiko_rel'\n\n  d3.json(geoDataUrl, d => {\n    const geoData = topojson.feature(d, d.objects.rvr_districts)\n\n    d3.csv(dataUrl, data => {\n\n      d3.playbooks.choroplethMap.defaults({\n        color: COLORS,\n        nullColor: '#ededed',\n        cssNamespace,\n        height,\n        width,\n        data,\n        geoData,\n        yExtent,\n        getId: f => f.properties.RS,\n        responsiveSvg: true,\n      })\n\n      const maps = {}\n      // broadcast hilighting\n      const hilight = (master, slug, data) => {\n        // hilight all others:\n        Object.keys(maps).filter(s => s !== slug).map(k => {\n          maps[k].hilight(data)\n        })\n        if (!master) {\n          // trigger infobox update for master map\n          const control = maps[Object.keys(maps)[0]].control()\n          control.trigger(riot.EVT.updateInfobox, data)\n          control.trigger(riot.EVT.updateSelector, data)\n        }\n      }\n\n      const wrapper = d3.select(`#${wrapperId}`)\n      let i = 0\n      Object.keys(SUBJECTS).map(s => {\n        const elementId = `${wrapperId}--${s}`\n        const element = wrapper.append('div')\n          .attr('id', elementId)\n          .attr('class', 'multi-map__container')\n        element.append('h4').attr('class', 'multi-map__title').text(SUBJECTS[s])\n        maps[s] = d3.playbooks.choroplethMap({\n          elementId,\n          yCol: `${s}__${valueColSuffix}`\n        }).render()\n\n        // render master legends/infobox/selector for first iteration\n        if (!i) {\n          maps[s]\n            .infobox({\n              element: '#multi-maps-infobox',\n              template: `\n              <h4 class=\"cor-viz-ls__infobox-title\">Anteil der Risikoschüler</h4>\n              <p>in {GEN}</p>\n              <dl class=\"fixme\">\n                <dt>{math__risiko_rel} %</dd>\n                <dd>Mathe</dt>\n                <dt>{german__risiko_rel} %</dd>\n                <dd>Deutsch</dt>\n                <dt>{english_listen__risiko_rel} %</dd>\n                <dd>Englisch (Hören)</dt>\n                <dt>{english_read__risiko_rel} %</dd>\n                <dd>Englisch (Lesen)</dt>\n              </dl>\n              <p class=\"data--small\">Teilnehmer: {participating}</p>\n            `\n            })\n            .legend({\n              wrapperTemplate: `\n                <h4 class=\"multi-map__legend-title\">Anteil in %</h4>\n                <div class=\"multi-map__legend-items\">\n                  {body}\n                </div>`,\n              itemTemplate: '<span class=\"multi-map__legend-item\" style=\"background-color:{color};\">{label}</span>',\n              element: '#multi-maps-legend'\n            })\n            .selector({\n              element: '#multi-maps-selector',\n              getLabel: f => f.GEN\n            })\n\n          // broadcast hilighting\n\n          maps[s].control().on(riot.EVT.updateInfobox, d => hilight(true, s, d))\n        } else {\n          maps[s].control().on(riot.EVT.mouseover, ({data}) => hilight(false, s, data))\n        }\n\n        i++\n      })\n\n    })\n\n  })\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/scripts/multi_maps.js"],"sourceRoot":""}